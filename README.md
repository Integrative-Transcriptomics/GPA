# GPA - Genome Profile Alignment

GPA is a Genome Profile Alignment tool. GPA relies on *progressiveMauve* for the underlying alignment, to compute several smaller sets of aligned genomes that are combined to a full WGA through their profiles. The profiles of the WGAs and their merging is conducted by using the SuperGenome data structure. GPA is implemented in Java 11 and offers a parallel computation of WGAs. For further information see our publication:


[> **Efficient merging of genome profile alignments** ](https://academic.oup.com/bioinformatics/article/35/14/i71/5529231)


## Dependencies

* progressiveMauve
* Java Virtual Machine (JRE 11)

# WGA computation

## Usage

<code>$ java -jar GPA.jar [GPAconfig File]</code>


## Config File Parameters

The config file has to contain the following parameters:

* <code>progressiveMauve</code> - progressiveMauve executable location
* <code>output_folder</code> - directory for output 
* <code>genome_folder</code> - directory containing the genome files in fasta-format
* <code>parsnp_tree</code> - guide tree produced by Parsnp
* <code>max_merge_size</code> - maximal merge size for guide tree compression 

optional parameters

* <code>threads</code> - number of threads that can be used for parallelized computation
* <code>keep_intermediate</code> - keep intermediate alignments of the merging steps


### Usage of Guide tree from progressiveMauve

Instead of the "parsnp_tree" paramete add the following to your configuration file
* <code>guide_tree</code> - guide tree produced by progressiveMauve
* <code>genome_files</code> - plain text file with genome names. Ordering has to match the input order of progressiveMauve!

An Example for the configuration file structure with the respective entries is contained in this repository.

Note: The guide tree generated by progressiveMauve needs the addition file listing all genomes, because the guide tree does not contain the respective file names. The ordering of the genomes has to match the input ordering of progressiveMauve.


## Output

After computation the output directory contains the following file:

* Folder containing the final WGA (mergedSG)
* Folders for intermediate WGAs (optional)

# Merging of WGAs and Genomes

The first thing to do is to create a configuration file for GPA, where the file locations of the WGAs and genomes that should be aligned are listed. An example for this procedure is contained in this repository (merge_example).

## Merge Configuration File creation

<code>$ java -jar GPA.jar [File with WGA/sequenc File locations] --createMergeConfig</code>

GPA will create several configuration files in the stated output folder. The important file for the next step is the *sg_Config.txt* file.

## Proceed with WGA computation by merging

<code>$ java -jar GPA.jar sg_Config.txt --mergeProfiles</code>

With the previous created *sg_Config.txt* file, GPA will merge all contained sequences/WGAs